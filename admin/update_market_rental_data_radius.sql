-- Update radius values in market_rental_data table
-- Generated on 2025-10-01
-- Updates radius based on user-provided correct values

BEGIN;
UPDATE public.market_rental_data SET radius = 0.0 WHERE region_id = 102001;
UPDATE public.market_rental_data SET radius = 7.5 WHERE region_id IN (394681,394559,394392,394523,394453,394917,394314,394685,845167,395000,394515,394880,395117,394821,394727,394719,395217,395237,394893,394857,395039,394932,394734,395168,395222,394630,395166,395080,753912,394410,394513,394505,394501,395140,395175,753887,394964,394373,394809,395248,395212,394568,395042,394744,395133,394682,395205,395126,395231,394738);
UPDATE public.market_rental_data SET radius = 7.5 WHERE region_id IN (394674,753928,753893,394472,395021,394885,394827,394360,395092,394899,394600,395020,394787,394759,394343,395199,394693,395124,395044,845162,394362,394939,394923,394456,394592,394444,753877,394737,394940,394951,394556,394604,394344,394571,394954,753905,394326,394628,395043,395008,394391,395017,394504,753916,395037,394567,395032,395129,394341,394844);
UPDATE public.market_rental_data SET radius = 7.5 WHERE region_id IN (394354,394881,394981,395227,394300,394507,394799,394771,394894,394617,394370,394920,394430,394569,395149,394419,394533,786262,394613,394835,394730,753871,394892,395198,395130,394718,394996,753880);
UPDATE public.market_rental_data SET radius = 10.0 WHERE region_id IN (394974,394803,753875,394447,394348,394924,395171,394811,395240,395174,394519,753895,845164,394765,394691,394726,395247,394716,394597,394680,395011,394380,395047,395202,395162,395009,394748,394729,394539,395246,394896,394299,394671,394428,395210,394480,394553,395007,395215,394731,394720,395170,394393,394710,395125,395079,394563,394873,394359,394662);
UPDATE public.market_rental_data SET radius = 10.0 WHERE region_id IN (394723,394598,394306,395223,395182,394800,394595,394783,395232,395221,394879,394756,394900,395139,394668,395094,394442,394728,394390,394661,394983,394890,394307,394633,394780,394474,395098,394325,394824,395128,394353,394321,394905,394588,395120,395218,394778,394635,395213,395089,394867,394333,395225,394423,395173,753872,394495,394788,394804,395023);
UPDATE public.market_rental_data SET radius = 10.0 WHERE region_id IN (394709,394637,394762,394369,394599,394733,394823,394462,395090,394542,395190,395038,395086,394882,394441,394580,394988,394641,394907,394925,394644,394859,394675,394489,394452,394445,753881,394866,394699,394593,394614,394516,394298,394752,394829,394701,394631,394551,394411,394446,394547,395204,394363,394503,394478,394448,394345,395085,394994,395010);
UPDATE public.market_rental_data SET radius = 10.0 WHERE region_id IN (394736,394955,394683,395088,395132,394647,394764,394877,394305,394826,394586,395016,394496,394836,394629,395071,394336,394331,394340,394349,394364,394365,394376,394384,394395,394396,394469,394524,394526,394537,394550,394570,394583,394591,753904,394615,394625,394652,394655,394676,753890,394689,394704,394721,394722,394739,394751,394755,394774,394785);
UPDATE public.market_rental_data SET radius = 10.0 WHERE region_id IN (394794,394802,394814,394822,394830,394833,394854,394852,394863,394868,394884,394891,394906,394912,394928,394934,394941,394958,394978,395035,395040,395036,395041,395054,395058,395097,395095,395123,395147,395152,395158,395163,395176,395191,394297,394310,394339,394350,753865,394375,394379,394437,394432,394490,394527,394582,394608,394616,394621,753884);
UPDATE public.market_rental_data SET radius = 10.0 WHERE region_id IN (394713,394717,394742,394749,394758,394850,394861,394876,394889,394919,394948,394961,394985,395026,845169,395062,395093,395122,395144,753923,395178,395216);
UPDATE public.market_rental_data SET radius = 12.5 WHERE region_id IN (394415,394952,753906,394440,394766,845159,394931,394528,394957,395075,394768,395245,394770,394590,394589,394971,394698,394995,394761,394898,395116,395195,394746,394338,395244,395183,753917,395048,395015,394820,394658,395051,394596,394972,394439,395070,395096,395164,394875,395146,394576,394901,394332,394927,394679,394697,394602,395033,394796,394622);
UPDATE public.market_rental_data SET radius = 12.5 WHERE region_id IN (394405,394646,395107,394645,394808,394471,395028,394579,394747,394741,395179,394660,394543,394937,395229,395061,394851,395197,394412,395103,395065,394772,394483,394732,394387,394609,394334,845160,395161,394813,394361,394378,394429,395030,394454,394848,394459,394763,394773,394464,394346,395114,394872,394565,394623,395118,395151,394386,395018,394960);
UPDATE public.market_rental_data SET radius = 12.5 WHERE region_id IN (394712,394406,395119,394707,394351,394860,753869,394944,394555,394651,394930,395193,394703,394639,395066,394493,395102,395013,394577,394368,395153,394407,394638);
UPDATE public.market_rental_data SET radius = 15.0 WHERE region_id IN (394775,395005,394669,394425,394388,395031,394640,753924,395238,394938,394653,394308,394753,394367,394843,394908,394561,394318,394486,394457,394648,395134,394798,394304,394531,395115,394816,395235,395143,395006,395160,395224,394549,394352,394711,394666,395113,394460,394871,394997,394792,395068,395019,395050,394870,394421,394612,394372,394520,394488);
UPDATE public.market_rental_data SET radius = 15.0 WHERE region_id IN (395109,394572,394323,394455,394585,394485);
UPDATE public.market_rental_data SET radius = 17.5 WHERE region_id IN (394358,394458,394982,394466,394355,394735,394492,394705,394475,395194,394714,394862,394935,395012,394849,395022,394807,394910,395167,395169,394619,394312,394357,845158,394399,394484,394502,394327);
UPDATE public.market_rental_data SET radius = 20.0 WHERE region_id IN (394404,395025,395056,395148,395121,394943,394998,395045,395059,394902,395053);
UPDATE public.market_rental_data SET radius = 22.5 WHERE region_id IN (394856,394976,395057,394532,395078,394865,394530,395055);
UPDATE public.market_rental_data SET radius = 25.0 WHERE region_id IN (394913,753899,394463,394514,394692,395209,394347);

-- Set default radius of 7.5 for any MSAs not in the lookup table
UPDATE public.market_rental_data SET radius = 7.5 WHERE radius IS NULL OR region_id NOT IN (SELECT UNNEST(ARRAY[102001,394913,753899,394463,394514,394692,395209,394974,394856,394347,394404,394976,395057,395025,394532,395078,394865,395056,395148,394530,394358,395121,394943,394458,395055,394998,395045,394982,394466,394355,394775,394735,394492,394705,394475,395059,394902,395194,395005,394714,394862,394935,395012,394849,395022,394807,394910,395053,394669,394425,394388,395031,394640,395167,753924,395169,394619,395238,394938,394415,394653,394312,394357,394308,394753,394367,394843,394908,394561,394318,394952,394486,753906,845158,394457,394648,395134,394440,394399,394484,394798,394766,394304,394531,395115,845159,394931,394816,395235,394528,395143,395006,395160,395224,394549,394352,394957,394711,394666,395113,395075,394460,394871,394768,394997,395245,394770,394590,394589,394792,394971,395068,395019,394698,394995,394761,394898,395116,395195,394746,394338,395244,395183,753917,395050,395048,394870,395015,394502,394421,394820,394612,394658,395051,394596,394972,394439,395070,394327,394372,395096,395164,394875,394520,395146,394576,394901,394332,394927,394679,394697,394602,395033,394796,394622,394405,394646,394488,395107,395109,394645,394808,394471,395028,394579,394747,394741,395179,394660,394543,394937,394803,395229,395061,753875,394851,395197,394447,394348,394412,395103,395065,394572,394924,394323,394772,395171,394483,394732,394811,394455,395240,394585,394387,394609,394334,845160,395161,394813,395174,394361,394519,394378,394429,395030,753895,394454,394848,845164,394459,394763,394773,394464,394681,394346,394765,394485,395114,394691,394872,394565,394726,395247,394623,394716,394597,394680,395118,395011,394380,395047,395202,395151,395162,395009,394386,395018,394748,394960,394729,394539,394559,394712,395246,394406,395119,394896,394299,394707,394351,394860,394671,753869,394944,394555,394651,394428,395210,394480,394553,395007,394392,395215,394731,394720,395170,394393,394930,394710,395125,395079,394523,394453,395193,394703,394639,394563,394917,394873,395066,394493,394314,394359,394685,394662,394723,394598,394306,845167,395102,395223,395182,394800,394595,395000,394515,394783,394880,395232,395221,394879,394756,394900,395013,395139,394577,395117,394668,394368,395094,394821,394442,394727,394728,394390,394661,394983,394890,394719,395153,394307,394633,394780,394474,395098,394325,394824,395128,394353,394321,394905,394588,395120,395218,394778,394635,395213,395089,395217,394867,395237,394407,394333,395225,394423,395173,753872,394495,394893,394857,395039,394788,394804,394932,394734,395023,395168,395222,394709,394637,394762,394369,394599,394630,394733,394823,395166,395080,394462,395090,394542,753912,395190,395038,395086,394882,394441,394580,394410,394513,394505,394988,394501,395140,395175,753887,394964,394373,394641,394809,395248,394907,394925,395212,394568,394644,395042,394859,394675,394744,395133,394489,394452,394682,395205,395126,394445,395231,753881,394866,394638,394699,394738,394674,394593,394614,394516,394298,753928,753893,394752,394472,395021,394829,394885,394827,394360,395092,394899,394600,395020,394787,394759,394343,395199,394701,394693,395124,394631,395044,845162,394362,394939,394923,394456,394592,394444,394551,753877,394737,394940,394411,394446,394951,394556,394547,395204,394604,394344,394571,394363,394503,394954,753905,394326,394628,394478,395043,395008,394391,395017,394504,753916,395037,394567,394448,395032,395129,394341,394844,394354,394881,394981,395227,394300,394507,394799,394771,394894,394617,394370,394920,394430,394569,395149,394419,394533,786262,394613,394835,394730,753871,394892,395198,395130,394718,394996,753880,394345,395085,394994,395010,394736,394955,394683,395088,395132,394647,394764,394877,394305,394826,394586,395016,394496,394836,394629,395071,394336,394331,394340,394349,394364,394365,394376,394384,394395,394396,394469,394524,394526,394537,394550,394570,394583,394591,753904,394615,394625,394652,394655,394676,753890,394689,394704,394721,394722,394739,394751,394755,394774,394785,394794,394802,394814,394822,394830,394833,394854,394852,394863,394868,394884,394891,394906,394912,394928,394934,394941,394958,394978,395035,395040,395036,395041,395054,395058,395097,395095,395123,395147,395152,395158,395163,395176,395191,394297,394310,394339,394350,753865,394375,394379,394437,394432,394490,394527,394582,394608,394616,394621,753884,394713,394717,394742,394749,394758,394850,394861,394876,394889,394919,394948,394961,394985,395026,845169,395062,395093,395122,395144,753923,395178,395216]));

COMMIT;

-- Verify the update
SELECT COUNT(*) as total_msas, COUNT(DISTINCT radius) as unique_radius_values FROM public.market_rental_data;
SELECT radius, COUNT(*) as msa_count FROM public.market_rental_data GROUP BY radius ORDER BY radius;